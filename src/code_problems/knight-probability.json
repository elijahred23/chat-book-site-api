{
  "id": "knight-probability",
  "title": "Knight Probability in Chessboard",
  "difficulty": "Hard",
  "functionName": "knightProbability",
  "runner": "knightProbability",
  "prompt": "You are given an n x n chessboard. A knight starts at (row, col) and makes exactly k moves. Each move is chosen uniformly at random from the 8 possible knight moves.\n\nReturn the probability that the knight remains on the board after k moves.\n\nReturn the exact value without rounding.",
  "constraintQuestions": [
    "Are coordinates 0-indexed? (Yes.)",
    "Can k be 0? (Yes.)",
    "Are moves only standard knight moves? (Yes.)",
    "Should we return 0 if the knight starts off the board? (Yes.)",
    "Do we round the probability? (No.)"
  ],
  "starterCode": "// Write your solution in JavaScript.\n// Requirement: define a function named knightProbability(n, k, row, col)\n// Return: probability that the knight stays on the board\n\nfunction knightProbability(n, k, row, col) {\n  // TODO: implement\n  return 0;\n}\n",
  "walkthrough": [
    {
      "title": "DP state",
      "body": "Let dp[steps][r][c] be the probability that the knight is on (r, c) after exactly steps moves.\nWe build from steps = 0 up to k."
    },
    {
      "title": "Transition",
      "body": "For each cell at step s, add its probability to the cells it can reach at step s + 1.\nEach move contributes dp[s][r][c] / 8 to a reachable cell."
    },
    {
      "title": "JavaScript (bottom-up, O(n^2) space)",
      "codeLanguage": "javascript",
      "body": "function knightProbability(n, k, row, col) {\n  const moves = [\n    [-2, -1], [-2, 1], [-1, 2], [1, 2],\n    [2, 1], [2, -1], [1, -2], [-1, -2]\n  ];\n\n  const prev = Array.from({ length: n }, () => Array(n).fill(0));\n  prev[row][col] = 1;\n\n  for (let step = 0; step < k; step += 1) {\n    const cur = Array.from({ length: n }, () => Array(n).fill(0));\n    for (let r = 0; r < n; r += 1) {\n      for (let c = 0; c < n; c += 1) {\n        if (prev[r][c] === 0) continue;\n        const share = prev[r][c] / 8;\n        for (const [dr, dc] of moves) {\n          const nr = r + dr;\n          const nc = c + dc;\n          if (nr >= 0 && nr < n && nc >= 0 && nc < n) {\n            cur[nr][nc] += share;\n          }\n        }\n      }\n    }\n    for (let r = 0; r < n; r += 1) {\n      for (let c = 0; c < n; c += 1) {\n        prev[r][c] = cur[r][c];\n      }\n    }\n  }\n\n  let total = 0;\n  for (let r = 0; r < n; r += 1) {\n    for (let c = 0; c < n; c += 1) {\n      total += prev[r][c];\n    }\n  }\n  return total;\n}\n"
    },
    {
      "title": "Complexity",
      "body": "Time: O(k * n^2 * 8) which is O(k * n^2).\nSpace: O(n^2) for two boards."
    }
  ],
  "tests": [
    {
      "name": "Example from prompt",
      "n": 6,
      "k": 2,
      "row": 2,
      "col": 2,
      "expect": 0.53125
    },
    {
      "name": "No moves",
      "n": 4,
      "k": 0,
      "row": 1,
      "col": 1,
      "expect": 1
    },
    {
      "name": "Small board, forced off",
      "n": 2,
      "k": 1,
      "row": 1,
      "col": 1,
      "expect": 0
    },
    {
      "name": "Single cell board",
      "n": 1,
      "k": 2,
      "row": 0,
      "col": 0,
      "expect": 0
    }
  ]
}
